#!/bin/bash

ips=(
65.99.252.19
65.99.252.172
72.249.55.24
174.136.25.9
174.136.28.105
72.249.55.19
174.136.38.38
174.136.52.203
174.136.37.107
174.136.37.108
174.136.37.109
65.99.225.31
65.99.225.37
65.99.225.41
65.99.225.55
174.136.25.23
174.136.25.35
65.99.225.81
207.210.229.118
174.136.38.17
207.210.229.91
207.210.228.67
207.210.229.84
198.59.144.5
198.59.144.6
198.59.144.7
198.59.144.8
198.59.144.15
198.59.144.16
198.59.144.17
198.59.144.18
198.59.144.19
65.99.225.24
198.59.144.25
65.99.225.140
65.99.252.142
65.99.252.56
174.136.25.166
65.99.225.206
65.99.225.134
65.99.225.56
174.136.25.26
65.99.225.136
174.136.53.219
174.136.53.220
198.59.144.126
198.59.144.127
198.59.144.139
198.59.144.140
198.59.144.141
65.99.252.179
65.99.252.27
65.99.252.41
198.59.144.35
198.59.144.178
198.59.144.179
198.59.144.180
198.59.144.181
198.59.144.182
198.59.144.249
)

echo -e "\nðŸ“¡ Escaneando servidores MySQL/MariaDB en puerto 3306 usando telnet...\n"

for ip in "${ips[@]}"; do
    # Abrimos conexiÃ³n, esperamos y cerramos
    banner=$( (echo quit; sleep 1) | timeout 6 telnet "$ip" 3306 2>/dev/null | head -n 5 )

    if [[ $? -eq 0 && -n "$banner" ]]; then
        version=$(echo "$banner" | grep -oEi 'MariaDB[-0-9\.]*|MySQL[-0-9\.]*' | head -1)
        if [[ -n "$version" ]]; then
            echo "[+] $ip -> $version"
        else
            echo "[?] $ip -> Conectado, pero versiÃ³n no detectada"
        fi
    else
        echo "[-] $ip -> Sin respuesta en puerto 3306"
    fi
done
